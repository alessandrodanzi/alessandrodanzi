###R code for remote sensing analysis##

setwd("/Users/alessandro/lab")

#raster (the format with pixels), from rastrum=aratro
install.packages("raster")
install.packages("RStoolbox")

library(raster)
#the satelite makes orbits called "paths" and covers the whole earth in 14-17 days.
#moreover, the "rows" that are parallel to the equator defines the points in the space

#to import images, the function is brick (to import a package of bands with different reflectance of pixels
#.grd = grid, network of images
p224r63_2011 <- brick("p224r63_2011_masked.grd")

plot(p224r63_2011)
cl <- colorRampPalette(c('black','grey','light grey'))(100) 
plot(p224r63_2011, col=cl)
 
#Bands of landsat
#B1: blue
#B2:green
#B3:red
#B4:NIR  #infrared

#multiframe of different plots
par(mfrow=c(2,2))
#2,2 means that we will have 2 rows and 2 columns with 4 plots in total.
#we do this because we will make a graph with 4 colour bands

#B1:blue
clb <- colorRampPalette(c('dark blue','blue','light blue'))(100) 
plot(p224r63_2011$B1_sre, col=clb)                        #the $ is used to link

#B2: with but with green (B2) 
clg <- colorRampPalette(c('dark green','green','light green'))(100) 
plot(p224r63_2011$B2_sre, col=clg)

#B3: with but with red (B3) 
clr <- colorRampPalette(c('dark red','red','salmon'))(100) 
plot(p224r63_2011$B3_sre, col=clr)

#B4: with but with NIR (B4) 
cln <- colorRampPalette(c('red','orange','yellow'))(100) 
plot(p224r63_2011$B4_sre, col=cln)

#exercise: make a graph with 4 plots on one column
par(mfrow=c(4,1))
#B1:blue
clb <- colorRampPalette(c('dark blue','blue','light blue'))(100) 
plot(p224r63_2011$B1_sre, col=clb)                        #the $ is used to link

#B2: with but with green (B2) 
clg <- colorRampPalette(c('dark green','green','light green'))(100) 
plot(p224r63_2011$B2_sre, col=clg)

#B3: with but with red (B3) 
clr <- colorRampPalette(c('dark red','red','salmon'))(100) 
plot(p224r63_2011$B3_sre, col=clr)

#B4: with but with NIR (B4) 
cln <- colorRampPalette(c('red','orange','yellow'))(100) 
plot(p224r63_2011$B4_sre, col=cln)



#to plot the 3 bands together and see ot how the human eye does
#RGB (red green blue)

plotRGB(p224r63_2011, r=3, g=2, b=1, stretch="Lin")

#stretch="Lin" stretch linear= to make a continuous between the colours
#every pixel is 30 km
#r=3, g=2, b=1 because from before
#Bands of landsat
#B1: blue
#B2:green
#B3:red

#if we want to use the NIR we have anyway to use 3 components and so we need to shift the components
plotRGB(p224r63_2011, r=4, g=3, b=2, stretch="Lin")
#vegetation is becoming red, the pink part is more related to agricultural fields, white parts are open areas (deforestation)

#exercise NIR on top on g component of the RGB
plotRGB(p224r63_2011, r=3, g=4, b=2, stretch="Lin")
#now the vegetation is in green, dark green is the water in the forest/humidity while pink is the bear soil (agriculture)

#exercise NIR on top on b component of the RGB
plotRGB(p224r63_2011, r=3, g=2, b=4, stretch="Lin")
#this time the agricultural area is in yellow (really easy to see)


